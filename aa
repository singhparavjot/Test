# Define the variable for dynamic input
variable "resource_config" {
  description = "Dynamic configuration for the resource"
  type        = map(any)
}

# Example resource using dynamic block
resource "azurerm_resource_type" "example" {
  name                = var.resource_config["name"]
  location            = var.resource_config["location"]
  resource_group_name = var.resource_config["resource_group_name"]

  # Dynamic block
  dynamic "property" {
    for_each = var.resource_config["properties"] != null ? var.resource_config["properties"] : []
    content {
      name  = property.value["name"]
      value = property.value["value"]
    }
  }
}





resource_config = {
  name                = "my-resource"
  location            = "East US"
  resource_group_name = "my-resource-group"
  properties = [
    { name = "property1", value = "value1" },
    { name = "property2", value = "value2" },
  ]
}




#### LIFE CYCLE management 

resource "azurerm_resource_type" "example" {
  name     = "example-resource"
  location = "East US"

  # Lifecycle block
  lifecycle {
    prevent_destroy = true  # Prevent accidental deletion
    ignore_changes  = [tags, "settings"]  # Ignore changes to specified attributes
    create_before_destroy = true  # Replace resource only after new resource is created
  }
}


